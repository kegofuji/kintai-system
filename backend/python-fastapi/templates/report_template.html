<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>勤怠管理レポート</title>
    <style>
        /* PDF用スタイルは pdf_service.py の _get_pdf_css() に統合 */
    </style>
</head>
<body>
    <!-- ヘッダー部分 -->
    <div class="header">
        <h1>勤怠管理レポート</h1>
        <div class="report-info">
            <div class="info-section">
                <span class="label">対象期間：</span>{{ period.from }} ～ {{ period.to }}
            </div>
            <div class="info-section">
                <span class="label">社員名：</span>{{ employee.employeeName }}
            </div>
            <div class="info-section">
                <span class="label">社員コード：</span>{{ employee.employeeCode }}
            </div>
            <div class="info-section">
                <span class="label">生成日時：</span>{{ generated_at }}
            </div>
        </div>
    </div>

    <!-- 日次明細テーブル -->
    <div class="daily-details">
        <h2>日次勤怠明細</h2>
        <table>
            <thead>
                <tr>
                    <th>日付</th>
                    <th>出勤時刻</th>
                    <th>退勤時刻</th>
                    <th>遅刻時間</th>
                    <th>早退時間</th>
                    <th>残業時間</th>
                    <th>深夜時間</th>
                    <th>ステータス</th>
                    <th>承認状況</th>
                </tr>
            </thead>
            <tbody>
                {% for record in attendance_list %}
                <tr>
                    <td>{{ record.attendanceDate }}</td>
                    <td>{{ record.clockInTime or '-' }}</td>
                    <td>{{ record.clockOutTime or '-' }}</td>
                    <td>{{ record.late_time_formatted }}</td>
                    <td>{{ record.early_leave_time_formatted }}</td>
                    <td>{{ record.overtime_time_formatted }}</td>
                    <td>{{ record.night_shift_time_formatted }}</td>
                    <td>{{ record.attendance_status_jp }}</td>
                    <td>
                        {% if record.attendanceFixedFlag %}
                            確定済
                        {% else %}
                            {{ record.submission_status_jp }}
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- 集計テーブル -->
    <div class="summary-section">
        <h2>月次集計</h2>
        <table class="summary-table">
            <tbody>
                <tr>
                    <th>実働時間合計</th>
                    <td>{{ summary.total_working_formatted }}</td>
                </tr>
                <tr>
                    <th>残業時間合計</th>
                    <td>{{ summary.total_overtime_formatted }}</td>
                </tr>
                <tr>
                    <th>深夜勤務時間合計</th>
                    <td>{{ summary.total_night_shift_formatted }}</td>
                </tr>
                <tr>
                    <th>遅刻時間合計</th>
                    <td>{{ summary.total_late_formatted }}</td>
                </tr>
                <tr>
                    <th>早退時間合計</th>
                    <td>{{ summary.total_early_leave_formatted }}</td>
                </tr>
                <tr>
                    <th>有給取得日数</th>
                    <td>{{ summary.paidLeaveDays }}日</td>
                </tr>
                <tr>
                    <th>欠勤日数</th>
                    <td>{{ summary.absentDays }}日</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- 遅刻・早退回数詳細 -->
    <div class="detail-counts">
        <h3>詳細情報</h3>
        <table class="summary-table">
            <tbody>
                <tr>
                    <th>遅刻回数</th>
                    <td>
                        {% set late_count = attendance_list | selectattr('lateMinutes', 'gt', 0) | list | length %}
                        {{ late_count }}回
                    </td>
                </tr>
                <tr>
                    <th>早退回数</th>
                    <td>
                        {% set early_count = attendance_list | selectattr('earlyLeaveMinutes', 'gt', 0) | list | length %}
                        {{ early_count }}回
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- フッター -->
    <div class="footer">
        <p>勤怠管理システム - PDFレポート出力</p>
        <p>※このレポートは自動生成されています</p>
    </div>
</body>
</html>